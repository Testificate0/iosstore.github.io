<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>App Store</title>
  <link id="theme-style" rel="stylesheet" href="ios.css" />
</head>
<body>
  <h1>RedStore</h1>

  <div class="platform-buttons">
    <div class="platform">
      <button onclick="toggleTheme('iOS')">iOS</button>
      <div class="dropdown" id="dropdown-iOS"></div>
    </div>
    <div class="platform">
      <button onclick="toggleTheme('Android')">Android</button>
      <div class="dropdown" id="dropdown-Android"></div>
    </div>
    <div class="platform">
      <button onclick="toggleTheme('Windows')">Windows</button>
      <div class="dropdown" id="dropdown-Windows"></div>
    </div>
  </div>

  <div class="app-list" id="app-list"></div>

  <script>
    const versionData = {
      "iOS": [4, 5, 6, 7, 8, 9],
      "Android": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11],
      "Windows": ["8.1", "10", "11"]
    };

    // Populate dropdowns
    for (const platform in versionData) {
      const dropdown = document.getElementById(`dropdown-${platform}`);
      versionData[platform].forEach(version => {
        const btn = document.createElement("button");
        btn.textContent = `Version ${version}`;
        btn.onclick = () => loadApps(platform, version);
        dropdown.appendChild(btn);
      });
    }

    function toggleDropdown(platform) {
      document.querySelectorAll('.dropdown').forEach(d => d.style.display = 'none');
      const dd = document.getElementById(`dropdown-${platform}`);
      dd.style.display = dd.style.display === 'block' ? 'none' : 'block';
    }

    function toggleTheme(platform) {
      const themeMap = {
        iOS: 'ios.css',
        Android: 'android.css',
        Windows: 'windows.css'
      };
      document.getElementById('theme-style').href = themeMap[platform];
      toggleDropdown(platform);
    }

    async function loadApps(platform, version) {
      const appList = document.getElementById('app-list');
      appList.innerHTML = 'Loading...';
      try {
        const response = await fetch('apps.json');
        const data = await response.json();
        const apps = data[platform]?.[version] || [];

        if (!apps.length) {
          appList.innerHTML = '<p>No apps found for this version.</p>';
          return;
        }

        appList.innerHTML = '';
        apps.forEach(app => {
          const card = document.createElement('div');
          card.className = 'app-card';

          const img = document.createElement('img');
          img.src = app.icon || '';
          img.alt = app.name;

          const name = document.createElement('p');
          name.textContent = app.name;

          const btn = document.createElement('button');
          btn.textContent = 'Install';
          btn.onclick = () => window.location.href = app.link;

          card.appendChild(img);
          card.appendChild(name);
          card.appendChild(btn);
          appList.appendChild(card);
        });
      } catch (err) {
        appList.innerHTML = '<p>Error loading apps.</p>';
        console.error(err);
      }
    }
  </script>
</body>
</html>
